<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Blacksmith Lab</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: #f0f0f0;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* THE LAB INTERFACE */
        .lab-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .station {
            background: #333;
            border: 2px solid #555;
            padding: 20px;
            border-radius: 10px;
            width: 300px;
            position: relative;
        }

        /* VISUALS - REPLACE THESE WITH REAL IMAGES LATER */
        #furnace-visual {
            width: 100%;
            height: 150px;
            background: linear-gradient(to bottom, #444, #222); /* Placeholder for Furnace Image */
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 5px solid #000;
        }
        
        #anvil-visual {
            width: 100%;
            height: 150px;
            background: #4a4e69; /* Placeholder for Anvil Image */
            clip-path: polygon(10% 20%, 90% 20%, 80% 100%, 20% 100%); /* CSS Shape: Anvil */
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* THE BILLET (METAL PIECE) */
        #billet {
            width: 100px;
            height: 40px;
            background-color: #777; /* Starts Cold Steel Color */
            border: 2px solid #000;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            transition: background-color 0.2s, width 0.1s, transform 0.1s;
        }

        /* CONTROLS */
        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
            font-weight: bold;
        }
        #btn-heat { background-color: #d9534f; color: white; }
        #btn-heat:active { background-color: #c9302c; }
        
        #btn-hammer { background-color: #f0ad4e; color: white; }
        #btn-hammer:active { transform: translateY(2px); }

        /* DASHBOARD */
        .dashboard {
            width: 80%;
            background: #222;
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            display: flex;
            justify-content: space-around;
        }
        .metric { font-size: 1.2em; }
        
        /* ANIMATIONS */
        @keyframes spark {
            0% { box-shadow: 0 0 0 yellow; }
            50% { box-shadow: 0 0 20px orange; }
            100% { box-shadow: 0 0 0 yellow; }
        }
        .hot { animation: spark 1s infinite; }

        /* LOG BOX */
        #log {
            height: 100px;
            overflow-y: auto;
            width: 600px;
            background: #000;
            color: #0f0;
            font-family: monospace;
            text-align: left;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #444;
        }
    </style>
</head>
<body>

    <h1>Virtual Blacksmith Simulator</h1>
    <p>Instruction: Heat the steel to the correct color (Orange/Yellow) then Hammer it.</p>

    <div class="dashboard">
        <div class="metric">Temp: <span id="temp-val">25</span>Â°C</div>
        <div class="metric">Shape Progress: <span id="shape-val">0</span>%</div>
        <div class="metric">Integrity: <span id="integrity-val">100</span>%</div>
    </div>

    <div class="lab-container">
        <div class="station" id="furnace-station">
            <h3>1. The Furnace</h3>
            <div id="furnace-visual">
                <div id="fire-glow" style="width:50px; height:50px; border-radius:50%; background:orange; opacity:0.2;"></div>
            </div>
            <button id="btn-heat" onmousedown="startHeating()" onmouseup="stopHeating()" onmouseleave="stopHeating()">HOLD TO HEAT</button>
        </div>

        <div class="station" id="anvil-station">
            <h3>2. The Anvil</h3>
            <div id="anvil-visual">
                <div id="billet"></div> </div>
            <button id="btn-hammer" onclick="hammerStrike()">CLICK TO HAMMER</button>
        </div>
    </div>

    <div id="log">System Initialized... Billet is Mild Steel (0.2% C).</div>

    <script>
        // GAME VARIABLES
        let temperature = 25; // Celsius
        let shapeProgress = 0;
        let integrity = 100;
        let isHeating = false;
        let coolingRate = 2; // Temp loss per tick
        
        // DOM ELEMENTS
        const billet = document.getElementById('billet');
        const tempDisplay = document.getElementById('temp-val');
        const shapeDisplay = document.getElementById('shape-val');
        const integrityDisplay = document.getElementById('integrity-val');
        const log = document.getElementById('log');

        // GAME LOOP (Runs 20 times per second)
        setInterval(() => {
            // Cooling Logic
            if (!isHeating && temperature > 25) {
                temperature -= coolingRate;
            }
            
            // Heating Logic
            if (isHeating) {
                temperature += 15; // Heating rate
            }

            // Update UI
            updateBilletVisuals();
            tempDisplay.innerText = Math.floor(temperature);
            
            // Check Failure States
            if (temperature > 1450) {
                gameOver("MELTED! The steel turned to liquid. Game Over.");
                temperature = 25; resetGame();
            }
        }, 50);

        // CONTROLS
        function startHeating() { isHeating = true; document.getElementById('fire-glow').style.opacity = 1; }
        function stopHeating() { isHeating = false; document.getElementById('fire-glow').style.opacity = 0.2; }

        function hammerStrike() {
            // GAME PHYSICS LOGIC
            let effect = "";
            
            if (temperature < 700) {
                // COLD WORKING (BAD)
                integrity -= 20;
                effect = "CLANG! Too cold! The metal is cracking.";
                addLog(effect, "red");
                billet.style.transform = "rotate(5deg)";
                setTimeout(() => billet.style.transform = "rotate(0deg)", 100);
            } 
            else if (temperature >= 700 && temperature <= 900) {
                // WARM WORKING (OKAY)
                shapeProgress += 5;
                effect = "Thud. Moving slowly. Needs more heat.";
                addLog(effect, "yellow");
            } 
            else if (temperature > 900 && temperature < 1300) {
                // HOT WORKING (PERFECT)
                shapeProgress += 15;
                effect = "BANG! Perfect plastic deformation.";
                addLog(effect, "#0f0");
                // Animation
                billet.style.width = (100 + shapeProgress) + "px"; 
            } 
            else {
                // TOO HOT (BURNING)
                integrity -= 10;
                effect = "SPLAT! Too soft, grain structure damaged.";
                addLog(effect, "orange");
            }

            // Check Win/Loss
            if (integrity <= 0) {
                gameOver("CRITICAL FAILURE: The part shattered.");
                resetGame();
            }
            if (shapeProgress >= 100) {
                gameOver("SUCCESS! Part fully forged.");
                resetGame();
            }
            
            shapeDisplay.innerText = shapeProgress;
            integrityDisplay.innerText = integrity;
        }

        // VISUAL PHYSICS (COLOR TEMP CHART)
        function updateBilletVisuals() {
            let color = "#777"; // Default Gray
            if (temperature > 500) color = "#500"; // Dull Red
            if (temperature > 700) color = "#a00"; // Cherry Red
            if (temperature > 900) color = "#ff4500"; // Orange
            if (temperature > 1100) color = "#ffcc00"; // Yellow
            if (temperature > 1300) color = "#fff"; // White
            
            billet.style.backgroundColor = color;
            
            // Add glow if hot
            if (temperature > 800) {
                billet.style.boxShadow = `0 0 ${temperature/50}px ${color}`;
            } else {
                billet.style.boxShadow = "none";
            }
        }

        function addLog(msg, color) {
            log.innerHTML += `<div style="color:${color}">> ${msg}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        function gameOver(msg) {
            alert(msg);
        }

        function resetGame() {
            temperature = 25;
            shapeProgress = 0;
            integrity = 100;
            billet.style.width = "100px";
            log.innerHTML = "System Reset.";
        }
    </script>
</body>
</html>
